{"mappings":"oeACA,IAAAA,EAAAC,EAAA,SAEA,MAAMC,EAAO,CACXC,WAAYC,SAASC,cAAc,uBACnCC,SAAUF,SAASC,cAAc,qBACjCE,KAAMH,SAASC,cAAc,qBAC7BG,gBAAiBJ,SAASC,cAAc,oBAGpB,IAAI,EAAAL,EAAAS,SAY1B,SAASC,IACP,GAAuB,YAmGDN,SAASC,cAAc,uBAExBM,UAAUC,SAAS,wBAA0B,UAAY,SApG5E,OAGF,MAAMC,EAAwBC,KAAKC,MAAMC,aAAaC,QAAQ,YAE9D,GAAIJ,GASN,SAAyBK,GACvBhB,EAAKK,KAAKY,UAAYD,EACnBE,KAAIC,IACH,IAAIC,EAAmBR,KAAKC,MAAMC,aAAaC,QAAQ,WAmC7CG,KAAIG,GACTA,EAAMC,OAhCX,OAHIF,EAAQG,OAAS,IACnBH,EAAU,CAACA,EAAQ,GAAIA,EAAQ,GAAI,UAE9B,gCAAgCD,EAAMK,eAAeL,EAAMK,mGAEjBL,EAAMM,gIAGtBN,EAAMO,mDACPN,EAAQO,KACpC,kFAEkCR,EAAMS,aAAaC,MACrD,EACA,oDAMLF,KAAK,IAER,MAAMG,EAAc5B,SAASC,cAAc,gBAiBZ4B,EAhBH,UAiBvBjB,aAAaC,QAAQgB,IAI0C,IAA7DnB,KAAKC,MAAMC,aAAaC,QAAQgB,IAAkBR,OAlBvDO,EAAYE,MAAMC,QAAU,OAF5BH,EAAYE,MAAMC,QAAU,QAehC,IAAiCF,EAT/BG,IA1CEC,CAAgBxB,OACX,CACeT,SAASC,cAAc,gBAC/B6B,MAAMC,QAAU,QAC5BjC,EAAKK,KAAKY,UAAY,IAtB1BT,IAEAR,EAAKC,WAAWmC,iBAAiB,SAEjC,WACEpC,EAAKI,SAASK,UAAU4B,OAAO,wBAC/BrC,EAAKC,WAAWQ,UAAU6B,IAAI,wBAC9B9B,OAiFF,SAAS0B,IACP,MAAMK,EAAerC,SAASC,cAAc,QAAQoC,aAC9CC,EAAeC,OAAOC,OAEtBC,EAASzC,SAASC,cAAc,UAElCoC,EAAeC,GAEjBG,EAAOX,MAAMY,SAAW,QACxBD,EAAOX,MAAMa,OAAS,IACtBF,EAAOX,MAAMc,KAAO,IACpBH,EAAOX,MAAMe,MAAQ,MAGrBJ,EAAOX,MAAMY,SAAW,GACxBD,EAAOX,MAAMa,OAAS,GACtBF,EAAOX,MAAMc,KAAO,GACpBH,EAAOX,MAAMe,MAAQ,IA3BH7C,SAASC,cAAc,WAC/BiC,iBAAiB,SAASY,IACtCC,YAAW,IAAMzC,KAAmB,QAItC0C,OAAOd,iBAAiB,UAAU,SAAUe,GAC1CjB","sources":["src/js/watched-button.js"],"sourcesContent":["// import { json } from 'stream/consumers';\nimport TopMovies from './work-with-api.js';\n\nconst refs = {\n  watchedBtn: document.querySelector('.header_btn-watched'),\n  queueBtn: document.querySelector('.header_btn-queue'),\n  list: document.querySelector('.movie-collection'),\n  addToWatchedBtn: document.querySelector('.modal__btn-add'),\n};\n\nconst topMoviesList = new TopMovies();\n\nonWatchedMarkup();\n\nrefs.watchedBtn.addEventListener('click', onWatchedBtnClick);\n\nfunction onWatchedBtnClick() {\n  refs.queueBtn.classList.remove('header-active-button');\n  refs.watchedBtn.classList.add('header-active-button');\n  onWatchedMarkup();\n}\n\nfunction onWatchedMarkup() {\n  if (getActiveTab() !== 'watched') {\n    return;\n  }\n\n  const filmsFromLocalStorage = JSON.parse(localStorage.getItem('watched'));\n\n  if (filmsFromLocalStorage) {\n    topMoviesMarkUp(filmsFromLocalStorage);\n  } else {\n    const placeholder = document.querySelector('.placeholder');\n    placeholder.style.display = 'block';\n    refs.list.innerHTML = '';\n  }\n}\n\nfunction topMoviesMarkUp(movies) {\n  refs.list.innerHTML = movies\n    .map(movie => {\n      let movie_g = getGenrs(JSON.parse(localStorage.getItem('genres')));\n      if (movie_g.length > 2) {\n        movie_g = [movie_g[0], movie_g[1], 'Other'];\n      }\n      return `<li class=\"movies__item\" id=\"${movie.id}\" data-id=${movie.id}>\n    <a href=\"\" class=\"movies__link\">\n        <img src='https://image.tmdb.org/t/p/original${movie.poster_path\n        }' class=\"movie__image\" alt=\"Movie\">\n        <div class=\"movie__text-part\">\n            <h2 class=\"movie__title\">${movie.title}</h2>\n            <p class=\"movie__genre\">${movie_g.join(\n          ', '\n        )} <span class=\"stick\">|</span> \n                <span class=\"movie__year\">${movie.release_date.slice(\n          0,\n          4\n        )}</span></p>\n        </div>\n    </a>\n</li>`;\n    })\n    .join('');\n\n  const placeholder = document.querySelector('.placeholder');\n  if (isLocalStorageItemEmpty('watched')) {\n    placeholder.style.display = 'block';\n  } else {\n    placeholder.style.display = 'none';\n  }\n\n  //Make footer sticky\n  makeFooterBottom();\n}\n\nfunction getGenrs(genres) {\n  return genres.map(genre => {\n    return genre.name;\n  });\n}\n\nfunction isLocalStorageItemEmpty(localStorageKey) {\n  if (!localStorage.getItem(localStorageKey)) {\n    return true;\n  }\n\n  return JSON.parse(localStorage.getItem(localStorageKey)).length === 0;\n}\n\n//Rerender after delete movie\nconst btnAddToWatch = document.querySelector('.wached');\nbtnAddToWatch.addEventListener('click', e => {\n  setTimeout(() => onWatchedMarkup(), 100); //Dirty hack due to late work with localstorage\n});\n\n//Make footer down if window size changed\nwindow.addEventListener('resize', function (event) {\n  makeFooterBottom();\n});\n\nfunction makeFooterBottom() {\n  const offsetHeight = document.querySelector('body').offsetHeight;\n  const screenHeight = screen.height;\n\n  const footer = document.querySelector(\"footer\");\n\n  if (offsetHeight < screenHeight) {\n    //We should make footer sticky\n    footer.style.position = \"fixed\";\n    footer.style.bottom = \"0\";\n    footer.style.left = \"0\";\n    footer.style.right = \"0\";\n  } else {\n    //Footer it's ok, shouldn't fix it\n    footer.style.position = \"\";\n    footer.style.bottom = \"\";\n    footer.style.left = \"\";\n    footer.style.right = \"\";\n  }\n}\n\nfunction getActiveTab() {\n  const watchedButton = document.querySelector('.header_btn-watched');\n\n  return watchedButton.classList.contains('header-active-button') ? \"watched\" : \"queue\";\n}"],"names":["$kKeZA","parcelRequire","$a1027229eaaf7cd3$var$refs","watchedBtn","document","querySelector","queueBtn","list","addToWatchedBtn","default","$a1027229eaaf7cd3$var$onWatchedMarkup","classList","contains","filmsFromLocalStorage","JSON","parse","localStorage","getItem","movies","innerHTML","map","movie","movie_g","genre","name","length","id","poster_path","title","join","release_date","slice","placeholder","localStorageKey","style","display","$a1027229eaaf7cd3$var$makeFooterBottom","$a1027229eaaf7cd3$var$topMoviesMarkUp","addEventListener","remove","add","offsetHeight","screenHeight","screen","height","footer","position","bottom","left","right","e","setTimeout","window","event"],"version":3,"file":"library.77ba6f1c.js.map"}