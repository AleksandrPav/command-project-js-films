{"mappings":"YAEA,MAAMA,EAAgBC,SAASC,cAAc,WACvCC,EAAgBF,SAASC,cAAc,UACvCE,EAAOH,SAASC,cAAc,qBAEpC,IAAIG,EAAgB,GAGpBL,EAAcM,iBAAiB,SAASC,KAiCxCC,eAAiCC,GAC/B,aAAaC,MACX,uCAAuCD,6DAEtCE,MAAKC,IACJ,IAAKA,EAASC,GACZ,MAAM,IAAIC,MAAMF,EAASG,QAE3B,OAAOH,EAASI,UAEjBL,MAAKM,GACGA,KAvCXC,CAHoBX,EAAEY,OAAOC,QAAQ,wBACXC,aAAa,YAEdV,MAAKW,IACxBC,aAAaC,QAAQ,aAEvBnB,EAAgBoB,KAAKC,MAAMH,aAAaC,QAAQ,aAElD,IAAIG,GAAgB,EACpB,IAAK,IAAIC,KAAMvB,EACb,GAAIuB,EAAGnB,KAAOa,EAAMb,GAAI,CACtBkB,GAAgB,EAChB,MAICA,IA4ET,SAA2BlB,GACzB,MACMoB,EADQJ,KAAKC,MAAMH,aAAaC,QAAQ,YACvBM,QAAOF,GAAMA,EAAGnB,KAAOA,IAC9Cc,aAAaQ,QAAQ,UAAWN,KAAKO,UAAUH,IA3E3CI,CAAkBX,EAAMb,IAC5BT,EAAckC,YAAc,mBAJxB7B,EAAc8B,KAAKb,GACnBC,aAAaQ,QAAQ,UAAWN,KAAKO,UAAU3B,QASnDL,EAAckC,YAAc,yBAqB9B9B,EAAKE,iBAAiB,SAEtB,SAA4BC,GAC1B,GAAIA,EAAEY,SAAWf,EAAM,CACrB,MAAMgC,EAAUC,SAAS9B,EAAEY,OAAOC,QAAQ,iBAAiBkB,QAAQ7B,IAC7D8B,EAAwBd,KAAKC,MAAMH,aAAaC,QAAQ,YACxDgB,EAAiBf,KAAKC,MAAMH,aAAaC,QAAQ,UAGvD,GAAIe,EAAuB,CACzB,IAAIE,GAAmB,EACzB,IAAK,MAAMC,KAAQH,EACbG,EAAKjC,KAAO2B,IACdK,GAAmB,GAKnBzC,EAAckC,YADZO,EAC0B,sBAGF,iBAK9B,GAAID,EAAgB,CAClB,IAAIC,GAAmB,EACzB,IAAK,MAAMC,KAAQF,EACbE,EAAKjC,KAAO2B,IACdK,GAAmB,GAKnBtC,EAAc+B,YADdO,EAC4B,oBAGF,oB","sources":["src/js/addtowatched.js"],"sourcesContent":["// (FT-18 За натисканням на кнопку \"Add to watched\" фільм додається до переглянутих фільмів поточного користувача (local-storage))\n\nconst btnAddToWatch = document.querySelector('.wached');\nconst btnAddToQueue = document.querySelector('.queue');\nconst btns = document.querySelector('.movie-collection'); \n\nlet watchedMovies = [];\n \n\nbtnAddToWatch.addEventListener('click', e => {\n\n  const isCardMovie = e.target.closest('.modal__card-content');\n  const movId = isCardMovie.getAttribute('data-id');\n\n  fetchMovieDetails(movId).then(movie => {\n    if (localStorage.getItem('watched')) {\n      \n      watchedMovies = JSON.parse(localStorage.getItem('watched'));\n    }\n    let isMovieExists = false;\n    for (let el of watchedMovies) {\n      if (el.id === movie.id) {\n        isMovieExists = true;\n        break;\n      }\n    }\n\n    if (!isMovieExists) {\n      watchedMovies.push(movie);\n      localStorage.setItem('watched', JSON.stringify(watchedMovies));\n    } else {\n      removeFromWatched(movie.id);\n  btnAddToWatch.textContent = 'add to Watched';\n\n\n    }\n  });\n    \n  btnAddToWatch.textContent = 'Remove from Watched';\n});\n\n\nasync function fetchMovieDetails(id) {\n  return await fetch(\n    `https://api.themoviedb.org/3//movie/${id}?api_key=7fea517bd5b294dd7a1b57e94e2c1c68&language=en-US`\n  )\n    .then(response => {\n      if (!response.ok) {\n        throw new Error(response.status);\n      }\n      return response.json();\n    })\n    .then(data => {\n      return data;\n    });\n}\n// localStorage.removeItem('watched')\n\n\nbtns.addEventListener('click', changeTextOnButton);\n\nfunction changeTextOnButton(e) {\n  if (e.target !== btns) {\n    const movieId = parseInt(e.target.closest('.movies__item').dataset.id);\n    const filmsFromLocalStorage = JSON.parse(localStorage.getItem('watched'));\n    const filmsFromQueue = JSON.parse(localStorage.getItem('queue'));\n   \n\n    if (filmsFromLocalStorage) {\n      let isMovieInLibrary = false;\n    for (const film of filmsFromLocalStorage) {\n      if (film.id === movieId) {\n        isMovieInLibrary = true;\n      }\n    }\n\n      if (isMovieInLibrary) {\n        btnAddToWatch.textContent = 'Remove from Watched';\n    }\n    else {\n      btnAddToWatch.textContent = 'Add to Watched';\n    }\n    }\n\n\n    if (filmsFromQueue) {\n      let isMovieInLibrary = false;\n    for (const film of filmsFromQueue) {\n      if (film.id === movieId) {\n        isMovieInLibrary = true;\n      }\n    }\n\n    if (isMovieInLibrary) {\n        btnAddToQueue.textContent = 'Remove from Queue';\n    }\n    else {\n      btnAddToQueue.textContent = 'Add to queue';\n    }\n    }\n  }\n}\n\nfunction removeFromWatched(id) {\n  const films = JSON.parse(localStorage.getItem('watched'));\n  const filtered = films.filter(el => el.id !== id);\n  localStorage.setItem('watched', JSON.stringify(filtered));\n}"],"names":["$d2f44f7d36d6b000$var$btnAddToWatch","document","querySelector","$d2f44f7d36d6b000$var$btnAddToQueue","$d2f44f7d36d6b000$var$btns","$d2f44f7d36d6b000$var$watchedMovies","addEventListener","e","async","id","fetch","then","response","ok","Error","status","json","data","$d2f44f7d36d6b000$var$fetchMovieDetails","target","closest","getAttribute","movie","localStorage","getItem","JSON","parse","isMovieExists","el","filtered","filter","setItem","stringify","$d2f44f7d36d6b000$var$removeFromWatched","textContent","push","movieId","parseInt","dataset","filmsFromLocalStorage","filmsFromQueue","isMovieInLibrary","film"],"version":3,"file":"library.bd198dfc.js.map"}