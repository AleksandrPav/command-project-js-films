{"mappings":"gfAEA,MAAMA,EAAS,IAAI,EAFnBC,EAAA,SAEmBC,SAEbC,EAAO,CACXC,KAAMC,SAASC,cAAc,qBAC7BC,OAAQF,SAASC,cAAc,gBAC/BE,QAASH,SAASC,cAAc,kBAChCG,WAAYJ,SAASC,cAAc,8BAGrCH,EAAKI,OAAOG,iBAAiB,UAI7B,SAAyBC,GACvBA,EAAEC,iBACFZ,EAAOa,YACPC,OAAOL,WAAWM,WAAWf,EAAOgB,MACpCb,EAAKM,WAAWC,iBAAiB,QAASO,GAwF5C,WACE,MAAMC,EAAUb,SAASC,cAAc,0BACnCY,GAAWA,EAAQC,UAAUC,SAAS,WACxCF,EAAQC,UAAUE,OAAO,UA1F3BC,GACAtB,EAAOuB,QAAUZ,EAAEa,OAAOC,SAASC,OAAOC,MAAMC,OAEhDC,OAGF,SAASA,IACP7B,EAAO8B,qBAdK,MAcyBC,MAAKC,IA0B5C,IAA+BC,EAAQC,EAzBnC,GAAkC,IAA9BF,EAAWG,QAAQC,OAKvB,IACE,MAAMC,EAAaC,KAAKC,MAAMC,aAAaC,QAAQ,WAmB1BR,EAlBHD,EAAWG,QAkBAD,EAlBSG,EAmB9ClC,EAAKC,KAAKsC,UAAYT,EACnBU,KAAIC,IACH,IAAIC,EAwCV,SAAkBC,EAAUZ,GAC1B,OAAOY,EAASH,KAAII,GACXb,EAAOc,MAAKC,GAASA,EAAMF,KAAOA,IAAIG,OA1C7BC,CAASP,EAAMQ,UAAWlB,GAExC,MAAO,oCAAoCU,EAAMG,oGAG7CH,EAAMS,gIAGuBT,EAAMU,mDAc7C,SAAwBpB,GACtB,OAAsB,IAAlBA,EAAOE,OACF,GACEF,EAAOE,OAAS,EAClB,GAAGF,EAAO,OAAOA,EAAO,YAExB,GAAG,IAAIA,GAAQqB,KAAK,QAnBOC,CACxBX,+EAsBYY,EAnBRb,EAAMc,aAoBlBD,EACKA,EAAKE,MAAM,EAAG,GAEd,iDAJX,IAA0BF,KAbrBF,KAAK,IAvCJ,MAAOK,GACPC,QAAQC,IAAIF,EAAMV,MAClBW,QAAQC,IAAIF,EAAMG,cAiEN1D,SAASC,cAAc,0BAC/Ba,UAAU6C,IAAI,aAUxB,SAAS/C,EAAWgD,GACdA,EAAMzC,SAAWrB,EAAKM,aAGtBwD,EAAMzC,OAAOL,UAAUC,SAAS,mBAClCpB,EAAOa,YACPgB,KAEEoC,EAAMzC,OAAOL,UAAUC,SAAS,kBAClCpB,EAAOkE,WACPrC,MAGAoC,EAAMzC,OAAOL,UAAUC,SAAS,iBAC/B6C,EAAMzC,OAAOL,UAAUC,SAAS,sBAChC6C,EAAMzC,OAAOL,UAAUC,SAAS,uBAEjCpB,EAAOmE,UAAUC,OAAOH,EAAMzC,OAAO6C,cACrCxC,KAEEoC,EAAMzC,OAAOL,UAAUC,SAAS,kBAClCpB,EAAOsE,WACPzC,KAEEoC,EAAMzC,OAAOL,UAAUC,SAAS,kBAClCpB,EAAOuE,UACP1C,KAEEoC,EAAMzC,OAAOL,UAAUC,SAAS,uBAClCpB,EAAOwE,WACP3C,KAEEoC,EAAMzC,OAAOL,UAAUC,SAAS,uBAClCpB,EAAOyE,UACP5C,KAGEoC,EAAMzC,OAAOL,UAAUC,SAAS,mBAC9B6C,EAAMzC,OAAOkD,cAAcvD,UAAUC,SAAS,uBAChDpB,EAAOwE,WACP3C,KAEEoC,EAAMzC,OAAOkD,cAAcvD,UAAUC,SAAS,uBAChDpB,EAAOyE,UACP5C,Q","sources":["src/js/movie-list-by-keyword.js"],"sourcesContent":["import TopMovies from './work-with-api';\n\nconst movies = new TopMovies();\n\nconst refs = {\n  list: document.querySelector('.movie-collection'),\n  formEl: document.querySelector('#search-form'),\n  inputEl: document.querySelector('.search__input'),\n  pagination: document.querySelector('#tui-pagination-container'),\n};\n\nrefs.formEl.addEventListener('submit', moviesByKeyword);\n\nlet keyword = null;\n\nfunction moviesByKeyword(e) {\n  e.preventDefault();\n  movies.resetPage();\n  window.pagination.movePageTo(movies.page);\n  refs.pagination.addEventListener('click', changePage);\n  removeErrorMessage();\n  movies.keyword = e.target.elements.search.value.trim();\n\n  fetchMoviesByKeyword();\n}\n\nfunction fetchMoviesByKeyword() {\n  movies.searchMovieByKeyword(keyword).then(moviesList => {\n    if (moviesList.results.length === 0) {\n      showErrorMessage();\n      return;\n    }\n\n    try {\n      const genresList = JSON.parse(localStorage.getItem('genres'));\n      moviesByKeywordMarkUp(moviesList.results, genresList);\n    } catch (error) {\n      console.log(error.name);\n      console.log(error.message);\n    }\n  });\n}\n\nfunction getGenrs(genresID, genres) {\n  return genresID.map(id => {\n    if (genres.find(genre => genre.id === id)) {\n      return genres.find(genre => genre.id === id).name;\n    } else {\n      return 'Self made';\n    }\n  });\n}\n\nfunction moviesByKeywordMarkUp(movies, genres) {\n  refs.list.innerHTML = movies\n    .map(movie => {\n      let movie_g = getGenrs(movie.genre_ids, genres);\n\n      return `<li class=\"movies__item\" data-id=${movie.id}>\n    <a href=\"\" class=\"movies__link\">\n        <img src='https://image.tmdb.org/t/p/original/${\n          movie.poster_path\n        }' class=\"movie__image\" alt=\"Movie\">\n        <div class=\"movie__text-part\">\n            <h2 class=\"movie__title\">${movie.title}</h2>\n            <p class=\"movie__genre\">${checkGenreList(\n              movie_g\n            )} <span class=\"stick\">|</span> \n                <span class=\"movie__year\">${checkReleaseDate(\n                  movie.release_date\n                )}</span></p>\n        </div>\n    </a>\n</li>`;\n    })\n    .join('');\n}\n\nfunction checkGenreList(genres) {\n  if (genres.length === 0) {\n    return '';\n  } else if (genres.length > 2) {\n    return `${genres[0]}, ${genres[1]}, Other`;\n  } else {\n    return `${[...genres].join(', ')}`;\n  }\n}\n\nfunction checkReleaseDate(date) {\n  if (date) {\n    return date.slice(0, 4);\n  } else {\n    return '';\n  }\n}\n\nfunction getGenrs(genresID, genres) {\n  return genresID.map(id => {\n    return genres.find(genre => genre.id === id).name;\n  });\n}\n\nfunction showErrorMessage() {\n  const errorEl = document.querySelector('.search__error-message');\n  errorEl.classList.add('active');\n}\n\nfunction removeErrorMessage() {\n  const errorEl = document.querySelector('.search__error-message');\n  if (errorEl && errorEl.classList.contains('active')) {\n    errorEl.classList.remove('active');\n  }\n}\n\nfunction changePage(event) {\n  if (event.target === refs.pagination) {\n    return;\n  }\n  if (event.target.classList.contains('tui-ico-first')) {\n    movies.resetPage();\n    fetchMoviesByKeyword();\n  }\n  if (event.target.classList.contains('tui-ico-last')) {\n    movies.lastPage();\n    fetchMoviesByKeyword();\n  }\n  if (\n    event.target.classList.contains('tui-page-btn') &&\n    !event.target.classList.contains('tui-next-is-ellip') &&\n    !event.target.classList.contains('tui-prev-is-ellip')\n  ) {\n    movies.cengePage(Number(event.target.textContent));\n    fetchMoviesByKeyword();\n  }\n  if (event.target.classList.contains('tui-ico-next')) {\n    movies.nextPage();\n    fetchMoviesByKeyword();\n  }\n  if (event.target.classList.contains('tui-ico-prev')) {\n    movies.prePage();\n    fetchMoviesByKeyword();\n  }\n  if (event.target.classList.contains('tui-next-is-ellip')) {\n    movies.nextElip();\n    fetchMoviesByKeyword();\n  }\n  if (event.target.classList.contains('tui-prev-is-ellip')) {\n    movies.preElip();\n    fetchMoviesByKeyword();\n  }\n\n  if (event.target.classList.contains('tui-ico-ellip')) {\n    if (event.target.parentElement.classList.contains('tui-next-is-ellip')) {\n      movies.nextElip();\n      fetchMoviesByKeyword();\n    }\n    if (event.target.parentElement.classList.contains('tui-prev-is-ellip')) {\n      movies.preElip();\n      fetchMoviesByKeyword();\n    }\n  }\n}\n"],"names":["$8ef68ecdc822f9b3$var$movies","parcelRequire","default","$8ef68ecdc822f9b3$var$refs","list","document","querySelector","formEl","inputEl","pagination","addEventListener","e","preventDefault","resetPage","window","movePageTo","page","$8ef68ecdc822f9b3$var$changePage","errorEl","classList","contains","remove","$8ef68ecdc822f9b3$var$removeErrorMessage","keyword","target","elements","search","value","trim","$8ef68ecdc822f9b3$var$fetchMoviesByKeyword","searchMovieByKeyword","then","moviesList","movies1","genres","results","length","genresList","JSON","parse","localStorage","getItem","innerHTML","map","movie","movie_g","genresID","id","find","genre","name","$8ef68ecdc822f9b3$var$getGenrs","genre_ids","poster_path","title","join","$8ef68ecdc822f9b3$var$checkGenreList","date","release_date","slice","error","console","log","message","add","event","lastPage","cengePage","Number","textContent","nextPage","prePage","nextElip","preElip","parentElement"],"version":3,"file":"index.70d4a038.js.map"}